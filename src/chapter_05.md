# 5. 함수

## 5-1. C 언어와 함수

### 작업 단위로 명령을 표현하는 방법

- 컴퓨터의 CPU는 단순화된 명령을 한 번에 하나씩 처리하도록 설계되어 있다.
- 프로그래밍 언어도 복잡한 표현법보다는 간단한 표현법을 나열하여 상황을 표현한다.
- 연속적인 행위들을 하나의 작업 단위로 묶어서 정의해 놓는다면 효율적이다.

### 함수란?

- C 언어 프로그램도 특별한 단위나 구분 없이 명령문들을 주욱 나열해서 작성하는 것보다 어떤 작업을 수행하는 일련의 명령문들을 한데 묶어서 그룹으로 만들어 두는 게 좋다.
- 작업별 그룹으로 나누어 작성한 소스 코드는 관리하기도 편할뿐더러 다른 프로그래머가 보거나 나중에라도 코드의 내용을 쉽게 이해할 수 있다.
- C 언어는 소스 코드를 그룹화할 수 있도록 함수(Function)라는 문법을 제공한다.
- C 언어는 소스 코드를 함수 단위로 나누어서 작성하는 것을 권장하기 때문에, 잘 작성한 C 언어 프로그램은 수많은 함수들로 이루어진 함수의 집합체라고 할 수 있다.

#### 특별한 기능을 가진 main 함수

```c
#include <stdio.h>

void main() {
    printf("Hello, world!");
}
```
- 소스 코드를 번역하는 컴파일러 입장에서는 어떤 함수가 최초로 시작되는 함수인지를 알아야 제대로 된 번역을 할 수 있다.
- C 언어는 `main`이라는 이름의 함수를 '프로그램 시작 함수'로 정해 놓았다.
- 즉 `main`함수는 '컴파일러에게 프로그램이 시작한다'고 알려주는 특별한 함수라고 생각하면 된다.

### C 언어 프로그램은 함수의 집합체이다

- C 언어의 소스 파일에는 꼭 하나 이상의 함수가 있다.
- C 언어로 작성한 프로그램은 함수들의 집합체이고 그 함수들끼리 서로 불러서 사용하는 형태로 진행된다.

## 5-2. 함수 정의하고 호출하기

### 함수 정의하기

```c
int Sum(int value1, int value2) {
    int result = value1 + value2;
    return result;
}
```
- 함수의 이름은 Sum이며 int형 정수 값 두 개를 입력 받아서 int형 결과 값을 반환하는 함수이다.
- 함수 이름, 변수 이름은 모두 프로그래머가 임의로 지은 이름이고 나머지는 예약어이다.
- 이렇게 코드를 써서 함수를 실제로 구현하는 행위를 '함수를 정의한다'라고 한다.
1. 함수 이름: 함수가 하는 일을 짐작하기 쉽게 짓는 것이 좋다.
2. 매개변수: 함수가 작업을 수행할 때 필요한 데이터가 있다면 변수 단위로 명시한다.
3. 작업 내용: 함수가 작업할 내용을 중괄호 {} 안에 명령문으로 나열한다.
4. 반환값: 함수가 작업한 결과 값을 반환해야 할 때 사용한다(선택 사항).

### 함수 호출하기

- 함수가 다른 함수를 사용하는 것을 '함수를 호출한다'고 한다.
- 즉 C 언어 프로그램은 함수가 다른 함수를 호출하면서 프로그램이 진행된다.
- 함수를 호출하는 함수를 호출자(Caller)라고 부르고 호출되는 함수를 피호출자(Callee)라고 한다.
```c
int Sum(int value1, int value2) {
    int result = value1 + value2;
    return value1 + value2;
}

void main() {
    int a = 2, b = 3, value;
    value = Sum(2, 3);
}
```

#### 함수 호출 과정 살펴보기

1. `main`함수가 `Sum`함수를 호출하면서 a와 b 값을 `Sum`함수에 전달한다.
2. `Sum`함수의 매개변수에 `main`함수에서 전달 받은 값이 복사된다.
3. 입력된 값으로 더하기 작업을 수행한다.
4. `main`함수로 결과 값을 반환한다.

### 함수의 매개변수 자세히 살펴보기

- 프로그램에서 사용하는 데이터는 필요할 때만 존재해야 효율적이므로 함수에서 필요할 때 만들었다가 함수가 끝날 때 함께 사라지도록 만드는 게 보통이다.
- 그래서 어떤 함수가 가지고 있던 데이터를 다른 함수에 전달하려면 다소 복잡한 표현법을 사용해야 한다.
- `main`함수는 `a`, `b`에 저장된 값을 더하기 위해 `Sum`함수를 호출하도록 구성했다.
- 그런데 함수 안에서 선언한 변수들은 해당 함수에서만 사용할 수 있기 때문에 `Sum`함수 내부에 선언된 `value1`, `value2`, `result`변수는 `Sum`함수에서만 사용할 수 있고, `main`함수 내부에 선언된 `a`, `b`변수는 `main`함수에서만 사용할 수 있다.
- 즉 `Sum`함수가 `a`, `b`를 직접 사용할 수 없기 때문에 `main`함수의 `a`, `b`변수 값을 `Sum`함수가 사용하기 위해 매개변수(Parameter)가 필요한 것이다.
- 매개변수는 호출자(`main`)에서 전달하는 값을 피호출자(`Sum`)에서 전달 받는 역할을 하는 변수를 의미하며 `Sum`함수의 `value1`과 `value2`가 여기에 해당한다.
- 이때 `main`에서 전달한 순서대로 `Sum`함수의 매개변수가 값을 전달 받기 때문에 순서와 개수를 잘 맞추어야 한다.

```c
#include <stdio.h>

int Sum(int value1, int value2) {
    int result = value1 + value2;
    return result;
}

void main() {
    int s;
    s = Sum(2, 3);
    printf("더하기 작업의 결과는 %d \n", s);
}
```
- `Sum`함수는 프로그램의 시작인 `main`함수보다 먼저 작성해야 한다.
- `main`함수 뒤에 작성하면 오류가 발생하는데, 이에 대한 자세한 내용은 [5-4]를 보자.
- `%d`는 정수를 출력할 때 사용하는 키워드이다.
- 이와 같이 출력을 위해 사용하는 여러 키워드들은 [6장]에서 배우자.
- 모든 함수가 매개변수를 가지는 것은 아니다.
- 특별히 호출자로부터 넘겨받을 정보가 없다면()안을 비워두거나 ()안에 `void`라고 적어 인자가 없음을 명시하면 된다.

### 함수의 반환값 자세히 살펴보기

#### 반환값이란?

- `Sum`함수가 수행한 결과 값을 호출자로 넘겨주면 `Sum`함수의 역할은 끝이 난다.
- 함수에서 `return`이라는 예약어를 사용하면 함수는 그 위치에서 종결되며, `return`뒤에 명시된 `result`변수 값이 `Sum`함수의 반환값(Return Value)이 된다.
- 함수가 값을 반환한다는 뜻은 호출자의 어떤 변수에 값을 대입한다는 뜻이기도 하다.
- 따라서 변수를 선언할 때처럼 함수 이름 앞에 함수의 반환값에 대한 자료형을 명시해야 한다.

> #### 함수의 반환값이 없는 경우도 있을까?
> 
> - 모든 함수가 반환값을 가지는 것은 아니다.
> - [12장]이후에 배울 포인터나 배열 문법은 문법 자체에 값을 반환하는 기능을 가지고 있다.
> - 따라서 `return`을 사용하여 결과 값을 반환할 필요가 없다.
> - 반환할 값이 없으면 함수 이름 앞에 `void`를 적고 `return`을 사용하지 않으면 된다.
> ```c
> void ZeroData(int *p) {
>     *p = 0;  // 전달된 주소에 가서 0을 대입한다(의미적으로 0이 반환된 것).
> }
> ```
> - `void`형식으로 정의한 함수의 `return`뒤에 반환값을 적으면 오류로 처리된다.
> ```c
> void Test(int value1, int value2) {
>     int result = value1 + value2;
>     return result;  // 오류 발생
> }
> ```

#### return의 또 다른 역할

- `return`문은 값을 반환하는 기능 외에도 함수를 종료하는 기능도 가지고 있다.
- 따라서 단순히 함수를 종결할 목적으로 `return`을 사용할 때는 `return`뒤에 반환 값을 적지 않아도 오류가 발생하지 않는다.
```c
void Test(int value1, int value2) {
    int a = 5;
    return;  // Test 함수가 정상적으로 종료됨
    a = a + 1; // 오류는 아니지만 함수가 이미 종료되었기 때문에 실행되지 않음
}
```
- `return`문을 두 번 적으면 오류가 발생하지는 않지만 두 번째 `return`문은 실행되지 않는다.

### 함수 이름을 짓는 방법

- C 언어로 작성한 소스 코드는 '함수의 집합체'이다.
- 따라서 이 함수들은 서로를 구별하고 사용할 수 있는 기준이 필요한데 그것이 함수 이름(Function Name)이다.
- 함수 이름을 짓는 법은 변수 이름 짓는 법과 똑같다.
- 영문자(a~z, A~Z), 숫자(0~9) 그리고 밑줄(_)을 조합하여 구성할 수 있다.
- 하지만 이름 전체를 숫자로 구성하거나 숫자로 시작하는 이름은 오류가 발생하기 때문에 함수 이름으로 사용할 수 없다.
- 공백을 포함할 수 없다.
- 대·소문자를 구별한다.
- C 언어의 예약어는 함수 이름으로 사용할 수 없다.
- 한 프로그램에서 이름이 같은 함수가 두 개 이상 존재하는 경우에도 오류로 처리된다.

> #### 프로그래밍에서 버그란 무엇일까?
> 
> - 프로그래밍을 하다 보면 종종 오류가 발생한다.
> - 이때 겪는 오류는 크게 두 가지인데 구문 오류(Syntax Error)와 의미상 오류(Semantic Error)가 있다.
> - 구문 오류는 프로그래밍 언어가 제공하는 규칙을 제대로 지키지 않았을 때 발생한다.
> - 이런 경우는 컴파일하기 전에 편집기에서 표시해 주거나, 컴파일할 때 컴파일러가 체크해 알려주기 때문에 찾기 쉽다.
> - 반면에 의미상 오류는 '깡통이 맛있다'와 같은 문장처럼 문법적으로는 맞지만 의미적으로 틀릴 때 발생한다.
> - 이런 오류는 정말 찾기 어렵다.
> - 기계어로 번역할 때는 오류 없이 잘 번역되지만 프로그램을 실행하면 오류가 나서 중단되어 버리기 때문이다.
> - 이러한 상황을 프로그래밍에서 '버그가 발생했다'고 한다.
> - 프로그램에 버그가 발생하면 문법적으로는 문제가 없기 때문에 컴파일러가 오류 사항을 체크해주지 않는다.
> - 따라서 프로그래머가 일일이 소스를 보면서 왜 잘못된 결과가 나오는지 체크해야 하는데, 이렇게 버그를 해결하기 위해 작업하는 행위를 디버깅(Debugging)이라고 한다.

## 5-3. main 함수 정리하기

- 한 개의 프로그램에서 `main`함수는 반드시 한 개만 있어야 한다.
- `main`함수가 없거나 두 개 이상 존재하면 컴파일할 때 오류가 발생한다.
- `main`함수는 반환형이나 매개변수를 사용자가 별도로 정할 수 없다.
- 그 대신 몇 가지 정해진 형식을 사용할 수 있도록 되어 있다.

### main 함수의 반환값

- 사용자가 직접 프로그램을 실행시키는 경우도 있지만 특정 프로그램이 다른 프로그램을 실행시키는 경우도 있다.
- 만약 A라는 프로그램이 B라는 프로그램을 실행시켰다고 생각해보자.
- A프로그램 입장에서는 자신이 실행시킨 B프로그램이 정상적으로 작업을 완료했는지, 어떤 상태로 종료했는지 등을 확인해야 할 때가 있다.
- 이때 B프로그램이 A프로그램에게 자신의 상태 값을 알려주는 방법이 여러 가지 있는데, 그 중 하나가 `main`함수의 반환값이다.

#### int형으로 반환하기

- 프로그램의 상태를 알려주기 위해 `main`함수의 반환값으로 `int`형을 사용한다.
```c
int main() {
    return 1;  // 값 1을 반환함
}
```
- 예시에서 `return 1;`라고 한 것은 1이 참을 의미하므로 프로그램이 성공적으로 실행되었다는 것을 보여주기 위함이다.
- `main`함수의 반환값은 0, 1뿐만 아니라 어떤 값을 사용해도 상관없다.

#### void형으로 반환하기

- 프로그램에 특별히 반환할 내용이 없다면 `void`를 사용하면 된다.
```c
void main() {
    // 반환값 없음
}
```

### main함수의 매개변수

- 명령 프롬프트로 프로그램을 실행할 때, 실행 인자(Argument)를 적을 수 있다.
- 실행 인자는 공백으로 구분한다.
- 실행 인자는 프로그램이 시작할 때 넘겨 받는 정보를 말한다.
- 실행 인자 또한 프로그램 입장에서는 변수로 받기 때문에 `main`함수의 매개변수가 받는다.
```c
void main(int argc, char *argv[]) {
    // argc에는 실행 인자의 개수, argv에는 실행 인자값이 들어감
}
```
- `*argv[]`는 포인터형 배열인데, 이것은 뒤에서 포인터와 배열을 배워야 이해할 수 있다.
- 포인터가 n개 있다는 것을 의미하는 문법이다.
- 사용자가 실행 인자를 사용하든 사용하지 않든 프로그램에서 실행 인자를 받을 필요가 없다면 매개변수 없이 `main()`이라고 명시하거나, `void`를 사용하여 `main(void)`와 같이 매개변수가 없음을 확실히 명시하면 된다.

## 5-4. 함수 원형 선언하기

### 함수를 호출할 때 기억해야 할 것

- 컴파일러는 C 언어 소스 코드를 기계어로 번역할 때, 코드의 위쪽에서 아래쪽으로 내용을 읽으며 번역한다.
- 따라서 피호출자가 호출자의 위쪽에 있는 경우에는 번역에 문제가 생기지 않는다.
- 왜냐하면 컴파일러가 호출자에서 피호출자를 호출하는 명령을 기계어로 번역할 때 피호출자가 어떤 형태의 매개변수를 원하는지, 작업 후에 결과 값을 어떻게 반환하는지를 이미 읽어서 알고 있기 때문이다.
- 하지만 호출자가 피호출자보다 위에 놓이는 경우에는 피호출자를 호출하는 명령을 번역하는 시점에 아직 컴파일러는 피호출자를 본 적이 없어서 호출 작업과 관련된 코드를 구성할 수 없기 때문이다.

### 함수 원형이란?

- 프로그래밍을 하다 보면 두 함수가 서로를 호출하는 경우도 생긴다.
- 따라서 피호출자가 항상 호출자의 위쪽에 놓일 수는 없다.
- 이런 경우에 함수 원형(Function Prototype)을 사용해서 해결한다.
- 함수의 원형은 함수가 호출될 때 필요한 정보인 함수 이름, 매개변수, 반환 자료형을 포함하는 표현식이다.
```c
int Sum(int value1, int value2);  // 함수 원형 선언

void main() {
    int s;
    s = Sum(2, 3);
}

int Sum(int value1, int value2) {
    int result = value1 + value2;
    return result;
}
```
- 함수 원형을 미리 선언해 두면 이 프로그램의 소스 파일 어딘가에 해당 형식을 가진 함수가 존재한다는 것을 컴파일러가 인지하게 된다.
- 따라서 컴파일러는 함수의 원형을 참조하여 `main`함수에서 `Sum`함수를 호출하는 구조를 만들 수 있다.

> #### 함수 원형을 선언할 때 매개변수 이름을 생략할 수 있다.
> 
> - 함수의 호출 구조를 만들 때 매개변수 정보는 개수나 자료형만 사용하기 때문에 함수 원형을 적을 때 매개변수 이름을 생략해도 된다.
> - 하지만 오류가 발생하지 않는다고 해도 코드의 가독성을 위해 매개변수 이름은 생략하지 않는 것이 좋다.

- 함수를 '정의'하는 것과 '선언'하는 것을 헷갈리지 말자.
- 함수를 정의한다는 것은 실제로 함수를 만드는, 함수를 구현하는 행위를 의미한다.
- 함수를 선언한다는 뜻은 좀 더 명확히 이야기하면 '함수의 원형을 선언한다'는 뜻과 같다.
